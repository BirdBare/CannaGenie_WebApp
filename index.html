<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.0.3/socket.io.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
<script src="jquery.caret.js"></script>
<script src="jquery.tag-editor.min.js"></script>
<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
<link href="jquery.tag-editor.css" rel="stylesheet" type="text/css" media="all">

<center>
<div id="container" style="position:relative;"> 
    <img src="logo.png" alt="CannaGenie Logo"><br>
    <div id="cSearchBar" style="max-width:500px;">
      <input type="text" name="cSearch" id="cSearch"> 
    </div>
    <div id="cSubmit" style="position:relative; top:5px;" >
      <button id="cSubmitButton" type="button" onclick="getValues()"> I'm
      feeling lucky </button>
    </div>
</div>


<script>
  var socket = io();
  var socketId = "";

/*
--------------------------------------------
            Functions
--------------------------------------------
*/
  function SendSocket(id,data)
  {
    var obj = { ID:socketId, Data:data };
    socket.emit(id, obj)
  }

  function getValues()
  {
    var cSearchText = document.getElementById("cSearch").value;
    document.getElementById("cSearch").value = "";
    //get then reset .value incase user hit back button on result page

    if(cSearchText.length > 0)
    {
      socket.close();
      window.location = "results.html?" + "search=" + cSearchText + "&dispensary=";
    }
  }
/*
--------------------------------------------
            Socket functions
--------------------------------------------
*/
  socket.on("connect", function(data)
  {
    socketId = socket.id;
  });
  //get unique ID when connected.
/*
--------------------------------------------
            Tag search bar instance
--------------------------------------------
*/
  $('#cSearch').tagEditor({
      initialTags: [],
      delimiter: ',\t', 
      placeholder: 'Enter CannaGenie Tags...',
      forceLowercase: true,
      autocomplete: {
        delay:0 , 
        minLength: 1, 
        source: function(request, response) 
        {
          socket.emit("search",request.term, function (data)
          {
            response(data);
          });
        }
      }
  });

  $(document).keypress(function(event)
  {
    if(event.which == 13)
    {
      Recommend();
    }
  });
</script>
